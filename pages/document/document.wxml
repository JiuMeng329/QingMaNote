<view class="theme-{{theme}}">
<view id="page-root" class="{{globalStyleClass}}">
<!--pages/document/document.wxml-->
<navigation-bar title="{{pageTitle || 'æ–‡æ¡£'}}" back="{{currentTagId}}" color="{{theme === 'light' ? 'black' : (theme === 'dark' ? 'white' : '#c9d1d9')}}" background="{{theme === 'light' ? '#FFF' : (theme === 'dark' ? '#1E1E1E' : '#161b22')}}" theme="{{theme}}">
  <view slot="right">
    <!-- å¯ä»¥æ·»åŠ æœç´¢æŒ‰é’®ç­‰ -->
    <!-- <button bindtap="toggleSearch">æœ</button> -->
  </view>
</navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list">
  <view class="document-container">
    <!-- æœç´¢æ¡† -->
    <view class="search-box">
      <view class="search-input-wrapper">
        <icon type="search" size="14" color="#999"></icon>
        <input class="search-input" placeholder="æœç´¢æ–‡æ¡£æ ‡é¢˜æˆ–å†…å®¹..." value="{{searchValue}}" bindinput="onSearch" confirm-type="search"/>
        <icon wx:if="{{searchValue}}" type="clear" size="14" color="#999" bindtap="clearSearch"></icon>
      </view>
    </view>
    
    <!-- æ–‡æ¡£åˆ—è¡¨ -->
    <view class="document-list" wx:if="{{documents.length > 0}}">
      <view class="document-item" wx:for="{{documents}}" wx:key="id" bindtap="viewDocument" data-id="{{item.id}}">
        <!-- æ–‡æ¡£å›¾æ ‡ -->
        <view class="document-icon">
           <image class="doc-icon-image" src="/image/icon_document.svg"></image>
           <!-- åç»­å¯ä»¥æ ¹æ® item.tags[0] çš„é¢œè‰²æ¥åŠ¨æ€è®¾ç½®å›¾æ ‡é¢œè‰²æˆ–èƒŒæ™¯ -->
        </view>
        <!-- æ–‡æ¡£ä¿¡æ¯ -->
        <view class="document-info">
          <view class="document-title">{{item.title}}</view>
          <view class="document-meta">
            <text>{{item.updateTimeFormatted}}</text>
            <!-- å¯ä»¥æ·»åŠ å…¶ä»–å…ƒä¿¡æ¯ï¼Œå¦‚å­—æ•°ã€æ–‡ä»¶å¤§å°ç­‰ -->
            <!-- <text class="dot-separator">Â·</text> -->
            <!-- <text>{{item.wordCount}} å­—</text> -->
          </view>
        </view>
        <!-- æ“ä½œæŒ‰é’® -->
        <view class="document-actions" catchtap="showDocActions" data-id="{{item.id}}">
          <view class="action-btn more">
            <text class="more-icon">â‹®</text> <!-- ä½¿ç”¨ä¸‰ä¸ªç‚¹å›¾æ ‡ -->
          </view>
        </view>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <block wx:else>
      <view class="empty-state">
        <image class="empty-icon" src="/image/icon_empty.svg" mode="aspectFit"></image>
        <view class="empty-text">{{searchValue ? 'æœªæ‰¾åˆ°ç›¸å…³æ–‡æ¡£' : (currentTagId ? 'æ­¤æ ‡ç­¾ä¸‹æš‚æ— æ–‡æ¡£' : 'æš‚æ— æ–‡æ¡£')}}</view>
        <view class="empty-subtext" wx:if="{{!searchValue}}">{{currentTagId ? 'å¯ä»¥å°è¯•å°†æ–‡æ¡£æ·»åŠ åˆ°æ­¤æ ‡ç­¾' : 'ç‚¹å‡»åº•éƒ¨å¯¼èˆªæ çš„ "+" æŒ‰é’®åˆ›å»ºæ–°æ–‡æ¡£'}}</view>
      </view>
    </block>
  </view>
</scroll-view>

<!-- æ–‡æ¡£æ“ä½œèœå• -->
<view class="action-menu {{showDocMenu ? 'show' : ''}}">
  <view class="menu-mask" bindtap="hideDocMenu"></view>
  <view class="menu-content">
    <view class="menu-title">{{currentDoc.title || 'æ–‡æ¡£æ“ä½œ'}}</view>
    <view class="menu-item" bindtap="renameDocument">
      <!-- <text class="menu-icon">âœ</text> -->
      <image class="menu-icon-image" src="/image/icon_rename.svg"></image>
      <text class="menu-text">é‡å‘½å</text>
    </view>
    <view class="menu-item" bindtap="shareDocument">
      <!-- <text class="menu-icon">â†—</text> -->
      <image class="menu-icon-image" src="/image/icon_share.svg"></image>
      <text class="menu-text">åˆ†äº«</text>
    </view>
    <view class="menu-item" bindtap="toggleFavorite">
      <!-- æ ¹æ® currentDoc.favorite åŠ¨æ€æ˜¾ç¤ºå›¾æ ‡å’Œæ–‡å­— -->
      <!-- <text class="menu-icon">{{currentDoc.favorite ? 'â˜…' : 'â˜†'}}</text> -->
      <image wx:if="{{currentDoc.favorite}}" class="menu-icon-image" src="/image/icon_favorite_selected.svg"></image>
      <image wx:else class="menu-icon-image" src="/image/icon_favorite_unselected.svg"></image>
      <text class="menu-text">{{currentDoc.favorite ? 'å–æ¶ˆæ”¶è—' : 'æ”¶è—'}}</text>
    </view>
    <!-- <view class="menu-item" bindtap="moveToFolder">-->
    <view class="menu-item" bindtap="addTag">
      <!-- <text class="menu-icon">ğŸ·</text> -->
      <image class="menu-icon-image" src="/image/icon_manage_tags.svg"></image>
      <text class="menu-text">ç®¡ç†æ ‡ç­¾</text> <!-- æ”¹ä¸ºç®¡ç†æ ‡ç­¾æ›´åˆé€‚ -->
    </view>
    <!-- <view class="menu-item" bindtap="archiveDocument">-->
    <!--   <text class="menu-icon">ğŸ“¥</text>-->
    <!--   <text class="menu-text">å½’æ¡£</text>-->
    <!-- </view>-->
    <view class="menu-item delete" bindtap="deleteDocument">
      <!-- <text class="menu-icon">ğŸ—‘</text> -->
      <image class="menu-icon-image" src="/image/icon_delete_red.svg"></image> <!-- ä½¿ç”¨å›ºå®šçº¢è‰²çš„åˆ é™¤å›¾æ ‡ -->
      <text class="menu-text">åˆ é™¤</text>
    </view>
    <view class="menu-cancel" bindtap="hideDocMenu">å–æ¶ˆ</view>
  </view>
</view>
</view>
</view>